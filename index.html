<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Typing Master - Advanced</title>
<style>
  :root {
    --primary-color: #4CAF50;
    --secondary-color: #8BC34A;
    --bg-light: #e8f5e9;
    --text-light: #212121;
    --card-bg: #ffffff;
    --border-color: #c8e6c9;
    --shadow-color: rgba(76, 175, 80, 0.2);
  }

  /* üåô Dark mode variables */
  body.dark-mode {
    --primary-color: #90caf9;
    --secondary-color: #64b5f6;
    --bg-light: #121212;
    --text-light: #f5f5f5;
    --card-bg: #1e1e1e;
    --border-color: #333;
    --shadow-color: rgba(0,0,0,0.6);
  }

/* üåó Dark Mode Toggle Emoji Only */
.toggle {
  position: fixed;
  top: 25px;
  right: 25px;
  background: none;          /* no background */
  border: none;              /* no border */
  border-radius: 0;          /* no shape */
  width: auto;               /* auto size to fit emoji */
  height: auto;
  padding: 5px;              /* a little padding for click area */
  cursor: pointer;
  box-shadow: none;          /* remove square shadow */
  transition: transform 0.2s, opacity 0.3s;
  z-index: 2001;
  opacity: 0.7;
}

.toggle:hover { 
  transform: scale(1.2); 
  opacity: 1; 
}

.toggle-icon { 
  font-size: 28px; 
  line-height: 1; 
  pointer-events: none; 
}

  body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; background: var(--bg-light); color: var(--text-light); transition: background 0.3s, color 0.3s; }
  .container { 
  width: 100%;                /* take full screen width */
  max-width: 100%;            /* no fixed 900px limit */
  margin: 0;                  /* remove side gaps */
  border-radius: 0;           /* remove curve for fullscreen look */
  padding: 30px; 
  background: var(--card-bg); 
  box-shadow: none;           /* optional: remove floating card look */
  position: relative; 
  box-sizing: border-box; 
}

  h1 { text-align: center; margin-bottom: 10px; color: var(--primary-color); }
  p.subtitle { text-align: center; margin-bottom: 30px; color: #666; }
  .controls { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin-bottom: 20px; }
  input, select, button { padding: 10px 15px; border-radius: 8px; border: 1.5px solid var(--border-color); font-size: 1rem; transition: all 0.3s; }
  button { background: var(--primary-color); color: #fff; border: none; font-weight: 700; cursor: pointer; transition: background 0.3s, transform 0.2s; }
  button:hover:not(:disabled) { background: var(--secondary-color); transform: translateY(-2px); }
  button:disabled { background: #bdbdbd; cursor: not-allowed; }
  .button-group { display: flex; gap: 10px; align-items: center; }
  .stats { display: flex; justify-content: space-around; margin-bottom: 20px; flex-wrap: wrap; gap: 15px; }
  .stat { background: var(--primary-color); color: white; padding: 20px 30px; border-radius: 15px; flex: 1 1 150px; text-align: center; }
  .stat h2 { margin-bottom: 5px; font-size: 2.2rem; }
  .sample-text, .typing-input { background: var(--bg-light); border-radius: 15px; padding: 25px; font-size: 1.1rem; border: 2px solid var(--border-color); min-height: 160px; margin-bottom: 20px; white-space: pre-wrap; width: 100%; overflow-wrap: break-word; word-wrap: break-word; box-sizing: border-box; transition: background 0.3s, color 0.3s; }
  .typing-input { resize: none; background-color: var(--card-bg); color: var(--text-light); }
  .typing-input:focus { border-color: var(--primary-color); box-shadow: 0 0 10px var(--shadow-color); }
  .progress-bar-container { background: #e0e0e0; border-radius: 10px; height: 12px; margin: 20px 0; overflow: hidden; }
  .progress-bar { height: 100%; background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); width: 0%; transition: width 0.3s ease; }
  .sample-text .correct { color: #28a745; }
  .sample-text .incorrect { color: #dc3545; text-decoration: line-through; }
  .sample-text .current { background: var(--primary-color); color: white; border-radius: 3px; padding: 0 2px; }
  footer { text-align: center; margin-top: 30px; font-size: 0.9rem; color: #888; }
  .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); justify-content: center; align-items: center; }
  .modal.show { display: flex; }
  .modal-content { background: var(--card-bg); padding: 30px; border-radius: 15px; text-align: center; max-width: 420px; width: 90%; transition: background 0.3s, color 0.3s; }
  .modal-content h2 { color: var(--primary-color); margin-bottom: 15px; }
  .modal-content button { margin: 10px; }
  .leaderboard-container { max-width: 900px; margin: 30px auto 20px auto; background: var(--card-bg); padding: 20px; border-radius: 15px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); transition: background 0.3s, color 0.3s; }
  #leaderboard { width: 100%; border-collapse: collapse; }
  #leaderboard th, #leaderboard td { padding: 10px; border-bottom: 1px solid #ddd; text-align: center; }
  #leaderboard th { background: var(--primary-color); color: #fff; }
  #adminLogin { position:fixed; bottom:10px; left:10px; opacity:0.2; font-size:12px; z-index:2000; }
  .leaderboard-filters { margin-bottom: 15px; text-align:center; }
</style>
</head>
<body>
<!-- üåó Dark Mode Toggle Button -->
<div id="toggle" class="toggle">
  <span id="toggleIcon" class="toggle-icon">üåô</span>
</div>

<div class="container">
  <h1>Typing Master - Advanced</h1>
  <p class="subtitle">Test your typing speed and accuracy with multiple difficulty levels and durations</p>

  <div class="controls">
    <label for="username">Name:</label>
    <input type="text" id="username" placeholder="Enter your name" />
  
    <label for="difficulty">Difficulty:</label>
    <select id="difficulty">
      <option value="easy">Easy</option>
      <option value="medium">Medium</option>
      <option value="hard">Hard</option>
      <option value="code">Code Practice</option>
    </select>

    <label for="duration">Duration:</label>
    <select id="duration"></select>

    <div class="button-group">
      <button id="startBtn">Start Test</button>
      <button id="resetBtn" disabled>Reset</button>
    </div>
  </div>

  <div class="stats">
    <div class="stat"><h2 id="wpm">0</h2><p>WPM</p></div>
    <div class="stat"><h2 id="accuracy">100%</h2><p>Accuracy</p></div>
    <div class="stat"><h2 id="timeLeft">0</h2><p>Seconds Left</p></div>
    <div class="stat"><h2 id="errors">0</h2><p>Errors</p></div>
  </div>

  <div class="sample-text" id="sampleText"></div>
  <textarea id="typingInput" class="typing-input" placeholder="Start typing here..." disabled spellcheck="false"></textarea>
  <div class="progress-bar-container"><div class="progress-bar" id="progressBar"></div></div>
</div>

<!-- Modal -->
<div id="resultModal" class="modal">
  <div class="modal-content">
    <h2>üéâ Congrats!</h2>
    <p id="resultWPM"></p>
    <p id="resultAccuracy"></p>
    <p id="resultErrors"></p>
    <button class="close-btn" id="closeModal">OK</button>
    <button class="close-btn" id="resetModal">üîÑ Reset Test</button>
  </div>
</div>

<!-- Leaderboard -->
<div class="leaderboard-container">
  <h2>üèÜ Leaderboard (Top 15)</h2>
  <div class="leaderboard-filters">
    <label for="filterCombo">Filter:</label>
    <select id="filterCombo">
      <option value="all">All</option>
      <optgroup label="Easy">
        <option value="easy-15">15s</option>
        <option value="easy-30">30s</option>
        <option value="easy-60">60s</option>
      </optgroup>
      <optgroup label="Medium">
        <option value="medium-30">30s</option>
        <option value="medium-60">60s</option>
        <option value="medium-120">120s</option>
      </optgroup>
      <optgroup label="Hard">
        <option value="hard-60">60s</option>
        <option value="hard-120">120s</option>
        <option value="hard-180">180s</option>
        <option value="hard-300">300s</option>
      </optgroup>
      <optgroup label="Code">
        <option value="code-120">120s</option>
        <option value="code-180">180s</option>
        <option value="code-300">300s</option>
      </optgroup>
    </select>
  </div>
  <table id="leaderboard">
    <thead>
      <tr>
        <th>Rank</th>
        <th>Name</th>
        <th>WPM</th>
        <th>Accuracy</th>
        <th>Difficulty</th>
        <th>Duration</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <div id="adminControls" style="display:none; margin-top:15px;">
    <button id="clearLeaderboard">üóëÔ∏è Clear Leaderboard</button>
  </div>
</div>

<footer>Created by <strong>KRISHNA KANTH M</strong></footer>
<button id="adminLogin">Admin</button>

<script>
(() => {
  const sampleTexts = {
    easy: ["The quick brown fox jumps over the lazy dog near the river bank.", "Typing every single day will make you faster and more accurate.", "She sells seashells by the seashore and collects pretty white stones.", "A journey of a thousand miles begins with a single confident step.", "Practice typing without looking at the keyboard to improve muscle memory.", "Jack quickly amazed his friends by jumping gracefully over the tall fence.", "Good habits formed early in life will guide you towards great success.", "Time flies quickly when you are enjoying the little things around you.", "An apple a day keeps the doctor away, according to an old saying.", "Hard work and patience together create opportunities for lasting achievements."],
    medium: ["Programming is the process of creating instructions that tell a computer how to work.", "Reading books regularly helps to expand your vocabulary and develop your imagination.", "Typing speed improves with accuracy, so focus on fewer mistakes before chasing speed.", "Technology has changed the way we communicate, learn, and perform our daily work.", "The internet connects people instantly, no matter where they live around the world.", "Consistency always beats intensity when it comes to learning new valuable skills.", "Happiness is not ready made, but comes from positive choices and daily actions.", "Failure is an opportunity to begin again, this time with more intelligence.", "Discipline is the bridge that connects your goals with your accomplishments in life.", "Typing without looking at the keyboard is a powerful lifelong communication skill."],
    hard: ["In computer science, algorithms are well defined sets of steps designed to solve problems efficiently.", "Artificial intelligence and machine learning are transforming industries by enabling automation and prediction.", "Consistency in daily typing practice is essential for building both speed and long term accuracy.", "Cybersecurity is important as personal and financial data is increasingly stored on online platforms.", "Edge computing reduces latency by processing data closer to where it is generated in real time.", "Data science blends statistics, coding, and domain knowledge to extract meaning from large datasets.", "Natural language processing allows computers to interpret, analyze, and even generate human language.", "Quantum computing may eventually revolutionize fields like cryptography and molecular level simulations.", "Distributed systems are resilient because they reduce the risks of single points of failure.", "Typing under strict time limits with minimal mistakes builds confidence in real applications."],
    code: ["function sumArray(arr) { return arr.reduce((acc, val) => acc + val, 0); }", "for (let i = 1; i <= 5; i++) { console.log('Number is: ' + i); }", "if (user.isLoggedIn) { showDashboard(); } else { requestLogin(); }", "def factorial(n): return 1 if n == 0 else n * factorial(n - 1)", "const numbers = [1, 2, 3, 4, 5]; numbers.forEach(n => console.log(n * 2));", "while (count < 10): print('Current count is', count); count += 1", "public static void main(String[] args) { System.out.println('Hello Java'); }", "try { riskyFunction(); } catch(e) { console.error('Error:', e.message); }", "import math\nprint('Square root of 25 is', math.sqrt(25))", "class Dog { constructor(name) { this.name = name; } bark() { return 'woof'; } }"]
  };

  const durationOptions = {
    easy: [15, 30, 60],
    medium: [30, 60, 120],
    hard: [60, 120, 180, 300],
    code: [120, 180, 300]
  };

  let isAdmin = false;
  const difficultySelect = document.getElementById('difficulty');
  const durationSelect = document.getElementById('duration');
  const startBtn = document.getElementById('startBtn');
  const resetBtn = document.getElementById('resetBtn');
  const sampleTextEl = document.getElementById('sampleText');
  const typingInput = document.getElementById('typingInput');
  const wpmEl = document.getElementById('wpm');
  const accuracyEl = document.getElementById('accuracy');
  const timeLeftEl = document.getElementById('timeLeft');
  const errorsEl = document.getElementById('errors');
  const progressBar = document.getElementById('progressBar');
  const resultModal = document.getElementById("resultModal");
  const resultWPM = document.getElementById("resultWPM");
  const resultAccuracy = document.getElementById("resultAccuracy");
  const resultErrors = document.getElementById("resultErrors");
  const closeModal = document.getElementById("closeModal");
  const resetModal = document.getElementById("resetModal");
  const usernameInput = document.getElementById("username");
  const filterCombo = document.getElementById("filterCombo");

  let testText = '';
  let timer = null, timeLeft = 0, isTestRunning = false;
  let errors = 0, typedCharacters = 0, correctCharacters = 0;

  // Dark Mode
  const toggle = document.getElementById("toggle");
  const toggleIcon = document.getElementById("toggleIcon");
  if (localStorage.getItem("darkMode") === "true") {
    document.body.classList.add("dark-mode");
    toggleIcon.textContent = "‚òÄÔ∏è";
  }
  toggle.addEventListener("click", () => {
    document.body.classList.toggle("dark-mode");
    const isDark = document.body.classList.contains("dark-mode");
    localStorage.setItem("darkMode", isDark);
    toggleIcon.textContent = isDark ? "‚òÄÔ∏è" : "üåô";
  });

  function updateDurationOptions() {
    const diff = difficultySelect.value;
    const durations = durationOptions[diff];
    durationSelect.innerHTML = "";
    durations.forEach(d => {
      const opt = document.createElement("option");
      opt.value = d;
      opt.textContent = `${d} seconds`;
      durationSelect.appendChild(opt);
    });
  }

  function getRandomText(difficulty) {
    const texts = sampleTexts[difficulty];
    if (difficulty === "hard") {
      const duration = parseInt(durationSelect.value);
      if (duration >= 180) {
        let shuffled = texts.sort(() => 0.5 - Math.random());
        return shuffled.slice(0, 3).join(" ");
      }
      return texts[Math.floor(Math.random() * texts.length)];
    }
    return texts[Math.floor(Math.random() * texts.length)];
  }
  function getRandomText(difficulty) {
  const texts = sampleTexts[difficulty];

  if (difficulty === "hard") {
    const duration = parseInt(durationSelect.value);
    if (duration >= 180) {
      // Hard 180+ sec ‚Üí 3 sentences
      let shuffled = texts.sort(() => 0.5 - Math.random());
      return shuffled.slice(0, 3).join(" ");
    }
    return texts[Math.floor(Math.random() * texts.length)];
  }

  if (difficulty === "code") {
    const duration = parseInt(durationSelect.value);
    if (duration >= 180) {
      // Code 180+ sec ‚Üí 3 code snippets
      let shuffled = texts.sort(() => 0.5 - Math.random());
      return shuffled.slice(0, 3).join("\n\n");
    } else if (duration >= 120) {
      // Code 120 sec ‚Üí 2 code snippets
      let shuffled = texts.sort(() => 0.5 - Math.random());
      return shuffled.slice(0, 2).join("\n\n");
    }
    return texts[Math.floor(Math.random() * texts.length)];
  }

  // Easy & Medium ‚Üí always one sentence
  return texts[Math.floor(Math.random() * texts.length)];
}


  function initializeTest() {
  // ‚úÖ Stop any old timer
  if (timer) clearInterval(timer);
  timer = null;
  isTestRunning = false;

  updateDurationOptions();

  // Pick new text
  testText = getRandomText(difficultySelect.value);
  sampleTextEl.innerHTML = "";
  testText.split("").forEach(char => {
    const span = document.createElement("span");
    span.textContent = char;
    sampleTextEl.appendChild(span);
  });

  typingInput.value = "";
  typingInput.disabled = true;

  // Reset stats
  wpmEl.textContent = 0;
  accuracyEl.textContent = "0%";   // ‚úÖ show 0% after reset
  errorsEl.textContent = 0;

  // Reset timer values
  timeLeft = parseInt(durationSelect.value);
  timeLeftEl.textContent = timeLeft;
  progressBar.style.width = "0%";

  // Buttons
  startBtn.disabled = false;   // ‚úÖ allow fresh start
  resetBtn.disabled = false;   // ‚úÖ keep reset usable
}


  function startTest() {
  if (!usernameInput.value.trim()) { 
    alert("Please enter your name!"); 
    return; 
  }
  if (isTestRunning) return;

  if (timer) clearInterval(timer);   // ‚úÖ ensure no old timer is running
  timer = null;

  isTestRunning = true;
  typingInput.value = "";
  typingInput.disabled = false;
  typingInput.focus();

  startBtn.disabled = true;
  resetBtn.disabled = false;

  const totalDuration = parseInt(durationSelect.value);
  const startTime = new Date().getTime();

  timer = setInterval(() => {
    const elapsed = (new Date().getTime() - startTime) / 1000;
    timeLeft = totalDuration - Math.floor(elapsed);
    timeLeftEl.textContent = Math.max(0, timeLeft);
    progressBar.style.width = `${Math.min(100, (elapsed / totalDuration) * 100)}%`;

    if (timeLeft <= 0) endTest();
    else updateStats();
  }, 1000);
}


  function endTest() {
    clearInterval(timer);
    isTestRunning = false;
    typingInput.disabled = true;
    resetBtn.disabled = false;
    progressBar.style.width = "100%";
    updateStats();
    resultWPM.textContent = `WPM: ${wpmEl.textContent}`;
    resultAccuracy.textContent = `Accuracy: ${accuracyEl.textContent}`;
    resultErrors.textContent = `Errors: ${errorsEl.textContent}`;
    const userName = usernameInput.value.trim() || "Guest";
    let scores = JSON.parse(localStorage.getItem("leaderboard") || "[]");
    let newScore = { name: userName, wpm: parseInt(wpmEl.textContent), accuracy: parseFloat(accuracyEl.textContent), difficulty: difficultySelect.value, duration: durationSelect.value };
    let existingIndex = scores.findIndex(s => s.name === userName);
    if (existingIndex >= 0) {
      if (newScore.wpm > scores[existingIndex].wpm) scores[existingIndex] = newScore;
    } else scores.push(newScore);
    scores.sort((a,b) => b.wpm - a.wpm); scores = scores.slice(0, 15);
    localStorage.setItem("leaderboard", JSON.stringify(scores));
    loadLeaderboard();
    resultModal.classList.add("show");
  }

  function updateStats() {
    const typedText = typingInput.value;
    const totalCharacters = typedText.length;
    let currentErrors = 0, currentCorrectCharacters = 0;
    const sampleSpans = sampleTextEl.querySelectorAll('span');
    sampleSpans.forEach((span, index) => {
      const charInSample = testText[index];
      const charInTyped = typedText[index];
      span.classList.remove('correct', 'incorrect', 'current');
      if (index < totalCharacters) {
        if (charInTyped === charInSample) { span.classList.add('correct'); currentCorrectCharacters++; }
        else { span.classList.add('incorrect'); currentErrors++; }
      }
    });
    if (totalCharacters < testText.length) sampleSpans[totalCharacters].classList.add('current');
    errors = currentErrors; typedCharacters = totalCharacters; correctCharacters = currentCorrectCharacters;
    errorsEl.textContent = errors;
    const elapsedSeconds = parseInt(durationSelect.value) - Math.max(0, timeLeft);
    const netWPM = (elapsedSeconds > 0) ? Math.round(((correctCharacters / 5) / (elapsedSeconds / 60))) : 0;
    wpmEl.textContent = isFinite(netWPM) && netWPM > 0 ? netWPM : 0;
    const accuracy = typedCharacters > 0 ? (correctCharacters / typedCharacters) * 100 : 0;
    accuracyEl.textContent = `${accuracy.toFixed(2)}%`;
    if (isTestRunning && typedText.length >= testText.length) endTest();
  }

  function loadLeaderboard() {
    let scores = JSON.parse(localStorage.getItem("leaderboard") || "[]");
    scores.sort((a,b) => b.wpm - a.wpm);
    const filterVal = filterCombo.value;
    let [diff, dur] = filterVal.split("-");
    if (filterVal !== "all") {
      scores = scores.filter(s => s.difficulty === diff && s.duration == dur);
    }
    const tbody = document.querySelector("#leaderboard tbody");
    tbody.innerHTML = "";
    scores.slice(0, 15).forEach((s, i) => {
      let deleteBtn = isAdmin ? `<button onclick="deleteEntry(${i})">‚ùå</button>` : "";
      tbody.innerHTML += `<tr>
        <td>${i+1}</td>
        <td>${s.name}</td>
        <td>${s.wpm}</td>
        <td>${s.accuracy}%</td>
        <td>${s.difficulty}</td>
        <td>${s.duration}s</td>
        <td>${deleteBtn}</td>
      </tr>`;
    });
  }

  window.deleteEntry = function(index) {
    let scores = JSON.parse(localStorage.getItem("leaderboard") || "[]");
    scores.splice(index, 1);
    localStorage.setItem("leaderboard", JSON.stringify(scores));
    loadLeaderboard();
  }

  startBtn.addEventListener('click', startTest);
  resetBtn.addEventListener('click', initializeTest);
  difficultySelect.addEventListener('change', () => {
  updateDurationOptions();   // refresh duration list
  initializeTest();          // reset text + stats
});

durationSelect.addEventListener('change', () => {
  testText = getRandomText(difficultySelect.value);  // only reload text for new duration
  sampleTextEl.innerHTML = "";
  testText.split("").forEach(char => {
    const span = document.createElement("span");
    span.textContent = char;
    sampleTextEl.appendChild(span);
  });
  timeLeft = parseInt(durationSelect.value);   // update timer correctly
  timeLeftEl.textContent = timeLeft;
});

  typingInput.addEventListener('input', updateStats);
  closeModal.addEventListener('click', () => resultModal.classList.remove("show"));
  resetModal.addEventListener('click', () => { resultModal.classList.remove("show"); initializeTest(); });
  filterCombo.addEventListener("change", loadLeaderboard);

  typingInput.addEventListener("paste", e => e.preventDefault());
  typingInput.addEventListener("copy", e => e.preventDefault());
  typingInput.addEventListener("cut", e => e.preventDefault());
  sampleTextEl.addEventListener("copy", e => e.preventDefault());

  document.getElementById("adminLogin").addEventListener("click", () => {
    let pwd = prompt("Enter admin password:");
    if (pwd === "1411Nazii") {
      isAdmin = true;
      document.getElementById("adminControls").style.display = "block";
      loadLeaderboard();
      alert("Admin mode activated!");
    } else {
      alert("Wrong password!");
    }
  });

  document.getElementById("clearLeaderboard").addEventListener("click", () => {
    if (confirm("Clear the entire leaderboard?")) {
      localStorage.removeItem("leaderboard");
      loadLeaderboard();
    }
  });

  initializeTest();
  loadLeaderboard();
})();
</script>
</body>
</html>


<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Typing Master - Advanced</title>
<style>
  :root {
    --primary-color: #4CAF50;
    --secondary-color: #8BC34A;
    --bg-light: #e8f5e9;
    --text-light: #212121;
    --card-bg: #ffffff;
    --border-color: #c8e6c9;
    --shadow-color: rgba(76, 175, 80, 0.2);
  }

  /* üåô Dark mode variables */
  body.dark-mode {
    --primary-color: #90caf9;
    --secondary-color: #64b5f6;
    --bg-light: #121212;
    --text-light: #f5f5f5;
    --card-bg: #1e1e1e;
    --border-color: #333;
    --shadow-color: rgba(0,0,0,0.6);
  }

/* üåó Dark Mode Toggle Emoji Only */
.toggle {
  position: fixed;
  top: 25px;
  right: 25px;
  background: none;          /* no background */
  border: none;              /* no border */
  border-radius: 0;          /* no shape */
  width: auto;               /* auto size to fit emoji */
  height: auto;
  padding: 5px;              /* a little padding for click area */
  cursor: pointer;
  box-shadow: none;          /* remove square shadow */
  transition: transform 0.2s, opacity 0.3s;
  z-index: 2001;
  opacity: 0.7;
}

.toggle:hover { 
  transform: scale(1.2); 
  opacity: 1; 
}

.toggle-icon { 
  font-size: 28px; 
  line-height: 1; 
  pointer-events: none; 
}

  body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; background: var(--bg-light); color: var(--text-light); transition: background 0.3s, color 0.3s; }
  .container { 
  width: 100%;                /* take full screen width */
  max-width: 100%;            /* no fixed 900px limit */
  margin: 0;                  /* remove side gaps */
  border-radius: 0;           /* remove curve for fullscreen look */
  padding: 30px; 
  background: var(--card-bg); 
  box-shadow: none;           /* optional: remove floating card look */
  position: relative; 
  box-sizing: border-box; 
}

  h1 { text-align: center; margin-bottom: 10px; color: var(--primary-color); }
  p.subtitle { text-align: center; margin-bottom: 30px; color: #666; }
  .controls { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin-bottom: 20px; }
  input, select, button { padding: 10px 15px; border-radius: 8px; border: 1.5px solid var(--border-color); font-size: 1rem; transition: all 0.3s; }
  button { background: var(--primary-color); color: #fff; border: none; font-weight: 700; cursor: pointer; transition: background 0.3s, transform 0.2s; }
  button:hover:not(:disabled) { background: var(--secondary-color); transform: translateY(-2px); }
  button:disabled { background: #bdbdbd; cursor: not-allowed; }
  .button-group { display: flex; gap: 10px; align-items: center; }
  .stats { display: flex; justify-content: space-around; margin-bottom: 20px; flex-wrap: wrap; gap: 15px; }
  .stat { background: var(--primary-color); color: white; padding: 20px 30px; border-radius: 15px; flex: 1 1 150px; text-align: center; }
  .stat h2 { margin-bottom: 5px; font-size: 2.2rem; }
  .sample-text, .typing-input { background: var(--bg-light); border-radius: 15px; padding: 25px; font-size: 1.1rem; border: 2px solid var(--border-color); min-height: 160px; margin-bottom: 20px; white-space: pre-wrap; width: 100%; overflow-wrap: break-word; word-wrap: break-word; box-sizing: border-box; transition: background 0.3s, color 0.3s; }
  .typing-input { resize: none; background-color: var(--card-bg); color: var(--text-light); }
  .typing-input:focus { border-color: var(--primary-color); box-shadow: 0 0 10px var(--shadow-color); }
  .progress-bar-container { background: #e0e0e0; border-radius: 10px; height: 12px; margin: 20px 0; overflow: hidden; }
  .progress-bar { height: 100%; background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); width: 0%; transition: width 0.3s ease; }
  .sample-text .correct { color: #28a745; }
  .sample-text .incorrect { color: #dc3545; text-decoration: line-through; }
  .sample-text .current { background: var(--primary-color); color: white; border-radius: 3px; padding: 0 2px; }
  footer { text-align: center; margin-top: 30px; font-size: 0.9rem; color: #888; }
  .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); justify-content: center; align-items: center; }
  .modal.show { display: flex; }
  .modal-content { background: var(--card-bg); padding: 30px; border-radius: 15px; text-align: center; max-width: 420px; width: 90%; transition: background 0.3s, color 0.3s; }
  .modal-content h2 { color: var(--primary-color); margin-bottom: 15px; }
  .modal-content button { margin: 10px; }
  .leaderboard-container { max-width: 900px; margin: 30px auto 20px auto; background: var(--card-bg); padding: 20px; border-radius: 15px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); transition: background 0.3s, color 0.3s; }
  #leaderboard { width: 100%; border-collapse: collapse; }
  #leaderboard th, #leaderboard td { padding: 10px; border-bottom: 1px solid #ddd; text-align: center; }
  #leaderboard th { background: var(--primary-color); color: #fff; }
  #adminLogin { position:fixed; bottom:10px; left:10px; opacity:0.2; font-size:12px; z-index:2000; }
  .leaderboard-filters { margin-bottom: 15px; text-align:center; }
</style>
</head>
<body>
<!-- üåó Dark Mode Toggle Button -->
<div id="toggle" class="toggle">
  <span id="toggleIcon" class="toggle-icon">üåô</span>
</div>

<div class="container">
  <h1>Typing Master - Advanced</h1>
  <p class="subtitle">Test your typing speed and accuracy with multiple difficulty levels and durations</p>

  <div class="controls">
    <label for="username">Name:</label>
    <input type="text" id="username" placeholder="Enter your name" />
  
    <label for="difficulty">Difficulty:</label>
    <select id="difficulty">
      <option value="easy">Easy</option>
      <option value="medium">Medium</option>
      <option value="hard">Hard</option>
      <option value="code">Code Practice</option>
    </select>

    <label for="duration">Duration:</label>
    <select id="duration"></select>

    <div class="button-group">
      <button id="startBtn">Start Test</button>
      <button id="resetBtn" disabled>Reset</button>
    </div>
  </div>

  <div class="stats">
    <div class="stat"><h2 id="wpm">0</h2><p>WPM</p></div>
    <div class="stat"><h2 id="accuracy">100%</h2><p>Accuracy</p></div>
    <div class="stat"><h2 id="timeLeft">0</h2><p>Seconds Left</p></div>
    <div class="stat"><h2 id="errors">0</h2><p>Errors</p></div>
  </div>

  <div class="sample-text" id="sampleText"></div>
  <textarea id="typingInput" class="typing-input" placeholder="Start typing here..." disabled spellcheck="false"></textarea>
  <div class="progress-bar-container"><div class="progress-bar" id="progressBar"></div></div>
</div>

<!-- Modal -->
<div id="resultModal" class="modal">
  <div class="modal-content">
    <h2>üéâ Congrats!</h2>
    <p id="resultWPM"></p>
    <p id="resultAccuracy"></p>
    <p id="resultErrors"></p>
    <button class="close-btn" id="closeModal">OK</button>
    <button class="close-btn" id="resetModal">üîÑ Reset Test</button>
  </div>
</div>

<!-- üîê Admin Login Modal -->
<div id="adminModal" class="modal">
  <div class="modal-content">
    <h2>Admin Login</h2>
    <input type="password" id="adminPassword" placeholder="Enter password" />
    <div style="margin-top:15px;">
      <button id="adminSubmit">Login</button>
      <button id="adminCancel">Cancel</button>
    </div>
  </div>
</div>

<div id="adminControls" style="display:none; margin-top:15px;">
  <button id="clearLeaderboard">üóëÔ∏è Clear Leaderboard</button>
  <button id="adminLogout">üîí Logout Admin</button>
</div>


<!-- Leaderboard -->
<div class="leaderboard-container">
  <h2>üèÜ Leaderboard (Top 15)</h2>
  <div class="leaderboard-filters">
    <label for="filterCombo">Filter:</label>
    <select id="filterCombo">
      <option value="all">All</option>
      <optgroup label="Easy">
        <option value="easy-15">15s</option>
        <option value="easy-30">30s</option>
        <option value="easy-60">60s</option>
      </optgroup>
      <optgroup label="Medium">
        <option value="medium-30">30s</option>
        <option value="medium-60">60s</option>
        <option value="medium-120">120s</option>
      </optgroup>
      <optgroup label="Hard">
        <option value="hard-60">60s</option>
        <option value="hard-120">120s</option>
        <option value="hard-180">180s</option>
        <option value="hard-300">300s</option>
      </optgroup>
      <optgroup label="Code">
        <option value="code-120">120s</option>
        <option value="code-180">180s</option>
        <option value="code-300">300s</option>
      </optgroup>
    </select>
  </div>
  <table id="leaderboard">
    <thead>
      <tr>
        <th>Rank</th>
        <th>Name</th>
        <th>WPM</th>
        <th>Accuracy</th>
        <th>Difficulty</th>
        <th>Duration</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <div id="adminControls" style="display:none; margin-top:15px;">
    <button id="clearLeaderboard">üóëÔ∏è Clear Leaderboard</button>
  </div>
</div>

<footer>Created by <strong>KRISHNA KANTH M</strong></footer>
<button id="adminLogin">Admin</button>

<script>
(() => {
  const sampleTexts = {
    easy: ["The quick brown fox jumps over the lazy dog near the river bank.", "Typing every single day will make you faster and more accurate.", "She sells seashells by the seashore and collects pretty white stones.", "A journey of a thousand miles begins with a single confident step.", "Practice typing without looking at the keyboard to improve muscle memory.", "Jack quickly amazed his friends by jumping gracefully over the tall fence.", "Good habits formed early in life will guide you towards great success.", "Time flies quickly when you are enjoying the little things around you.", "An apple a day keeps the doctor away, according to an old saying.", "Hard work and patience together create opportunities for lasting achievements."],
    medium: ["Programming is the process of creating instructions that tell a computer how to work.", "Reading books regularly helps to expand your vocabulary and develop your imagination.", "Typing speed improves with accuracy, so focus on fewer mistakes before chasing speed.", "Technology has changed the way we communicate, learn, and perform our daily work.", "The internet connects people instantly, no matter where they live around the world.", "Consistency always beats intensity when it comes to learning new valuable skills.", "Happiness is not ready made, but comes from positive choices and daily actions.", "Failure is an opportunity to begin again, this time with more intelligence.", "Discipline is the bridge that connects your goals with your accomplishments in life.", "Typing without looking at the keyboard is a powerful lifelong communication skill."],
    hard: ["In computer science, algorithms are well defined sets of steps designed to solve problems efficiently.", "Artificial intelligence and machine learning are transforming industries by enabling automation and prediction.", "Consistency in daily typing practice is essential for building both speed and long term accuracy.", "Cybersecurity is important as personal and financial data is increasingly stored on online platforms.", "Edge computing reduces latency by processing data closer to where it is generated in real time.", "Data science blends statistics, coding, and domain knowledge to extract meaning from large datasets.", "Natural language processing allows computers to interpret, analyze, and even generate human language.", "Quantum computing may eventually revolutionize fields like cryptography and molecular level simulations.", "Distributed systems are resilient because they reduce the risks of single points of failure.", "Typing under strict time limits with minimal mistakes builds confidence in real applications."],
    code: ["function sumArray(arr) { return arr.reduce((acc, val) => acc + val, 0); }", "for (let i = 1; i <= 5; i++) { console.log('Number is: ' + i); }", "if (user.isLoggedIn) { showDashboard(); } else { requestLogin(); }", "def factorial(n): return 1 if n == 0 else n * factorial(n - 1)", "const numbers = [1, 2, 3, 4, 5]; numbers.forEach(n => console.log(n * 2));", "while (count < 10): print('Current count is', count); count += 1", "public static void main(String[] args) { System.out.println('Hello Java'); }", "try { riskyFunction(); } catch(e) { console.error('Error:', e.message); }", "import math\nprint('Square root of 25 is', math.sqrt(25))", "class Dog { constructor(name) { this.name = name; } bark() { return 'woof'; } }"]
  };

  const durationOptions = {
    easy: [15, 30, 60],
    medium: [30, 60, 120],
    hard: [60, 120, 180, 300],
    code: [120, 180, 300]
  };

  let isAdmin = false;
  const difficultySelect = document.getElementById('difficulty');
  const durationSelect = document.getElementById('duration');
  const startBtn = document.getElementById('startBtn');
  const resetBtn = document.getElementById('resetBtn');
  const sampleTextEl = document.getElementById('sampleText');
  const typingInput = document.getElementById('typingInput');
  const wpmEl = document.getElementById('wpm');
  const accuracyEl = document.getElementById('accuracy');
  const timeLeftEl = document.getElementById('timeLeft');
  const errorsEl = document.getElementById('errors');
  const progressBar = document.getElementById('progressBar');
  const resultModal = document.getElementById("resultModal");
  const resultWPM = document.getElementById("resultWPM");
  const resultAccuracy = document.getElementById("resultAccuracy");
  const resultErrors = document.getElementById("resultErrors");
  const closeModal = document.getElementById("closeModal");
  const resetModal = document.getElementById("resetModal");
  const usernameInput = document.getElementById("username");
  const filterCombo = document.getElementById("filterCombo");

  let testText = '';
  let timer = null, timeLeft = 0, isTestRunning = false;
  let errors = 0, typedCharacters = 0, correctCharacters = 0;

  // Dark Mode
  const toggle = document.getElementById("toggle");
  const toggleIcon = document.getElementById("toggleIcon");
  if (localStorage.getItem("darkMode") === "true") {
    document.body.classList.add("dark-mode");
    toggleIcon.textContent = "‚òÄÔ∏è";
  }
  toggle.addEventListener("click", () => {
    document.body.classList.toggle("dark-mode");
    const isDark = document.body.classList.contains("dark-mode");
    localStorage.setItem("darkMode", isDark);
    toggleIcon.textContent = isDark ? "‚òÄÔ∏è" : "üåô";
  });

  function updateDurationOptions() {
    const diff = difficultySelect.value;
    const durations = durationOptions[diff];
    durationSelect.innerHTML = "";
    durations.forEach(d => {
      const opt = document.createElement("option");
      opt.value = d;
      opt.textContent = `${d} seconds`;
      durationSelect.appendChild(opt);
    });
  }

  function getRandomText(difficulty) {
    const texts = sampleTexts[difficulty];
    if (difficulty === "hard") {
      const duration = parseInt(durationSelect.value);
      if (duration >= 180) {
        let shuffled = texts.sort(() => 0.5 - Math.random());
        return shuffled.slice(0, 3).join(" ");
      }
      return texts[Math.floor(Math.random() * texts.length)];
    }
    return texts[Math.floor(Math.random() * texts.length)];
  }
  function getRandomText(difficulty) {
  const texts = sampleTexts[difficulty];

  if (difficulty === "hard") {
    const duration = parseInt(durationSelect.value);
    if (duration >= 180) {
      // Hard 180+ sec ‚Üí 3 sentences
      let shuffled = texts.sort(() => 0.5 - Math.random());
      return shuffled.slice(0, 3).join(" ");
    }
    return texts[Math.floor(Math.random() * texts.length)];
  }

  if (difficulty === "code") {
    const duration = parseInt(durationSelect.value);
    if (duration >= 180) {
      // Code 180+ sec ‚Üí 3 code snippets
      let shuffled = texts.sort(() => 0.5 - Math.random());
      return shuffled.slice(0, 3).join("\n\n");
    } else if (duration >= 120) {
      // Code 120 sec ‚Üí 2 code snippets
      let shuffled = texts.sort(() => 0.5 - Math.random());
      return shuffled.slice(0, 2).join("\n\n");
    }
    return texts[Math.floor(Math.random() * texts.length)];
  }

  // Easy & Medium ‚Üí always one sentence
  return texts[Math.floor(Math.random() * texts.length)];
}


  function initializeTest() {
  // ‚úÖ Stop any old timer
  if (timer) clearInterval(timer);
  timer = null;
  isTestRunning = false;

  updateDurationOptions();

  // Pick new text
  testText = getRandomText(difficultySelect.value);
  sampleTextEl.innerHTML = "";
  testText.split("").forEach(char => {
    const span = document.createElement("span");
    span.textContent = char;
    sampleTextEl.appendChild(span);
  });

  typingInput.value = "";
  typingInput.disabled = true;

  // Reset stats
  wpmEl.textContent = 0;
  accuracyEl.textContent = "0%";   // ‚úÖ show 0% after reset
  errorsEl.textContent = 0;

  // Reset timer values
  timeLeft = parseInt(durationSelect.value);
  timeLeftEl.textContent = timeLeft;
  progressBar.style.width = "0%";

  // Buttons
  startBtn.disabled = false;   // ‚úÖ allow fresh start
  resetBtn.disabled = false;   // ‚úÖ keep reset usable
}


  function startTest() {
  if (!usernameInput.value.trim()) { 
    alert("Please enter your name!"); 
    return; 
  }
  if (isTestRunning) return;

  if (timer) clearInterval(timer);   // ‚úÖ ensure no old timer is running
  timer = null;

  isTestRunning = true;
  typingInput.value = "";
  typingInput.disabled = false;
  typingInput.focus();

  startBtn.disabled = true;
  resetBtn.disabled = false;

  const totalDuration = parseInt(durationSelect.value);
  const startTime = new Date().getTime();

  timer = setInterval(() => {
    const elapsed = (new Date().getTime() - startTime) / 1000;
    timeLeft = totalDuration - Math.floor(elapsed);
    timeLeftEl.textContent = Math.max(0, timeLeft);
    progressBar.style.width = `${Math.min(100, (elapsed / totalDuration) * 100)}%`;

    if (timeLeft <= 0) endTest();
    else updateStats();
  }, 1000);
}


  function endTest() {
    clearInterval(timer);
    isTestRunning = false;
    typingInput.disabled = true;
    resetBtn.disabled = false;
    progressBar.style.width = "100%";
    updateStats();
    resultWPM.textContent = `WPM: ${wpmEl.textContent}`;
    resultAccuracy.textContent = `Accuracy: ${accuracyEl.textContent}`;
    resultErrors.textContent = `Errors: ${errorsEl.textContent}`;
    const userName = usernameInput.value.trim() || "Guest";
    let scores = JSON.parse(localStorage.getItem("leaderboard") || "[]");
    let newScore = { name: userName, wpm: parseInt(wpmEl.textContent), accuracy: parseFloat(accuracyEl.textContent), difficulty: difficultySelect.value, duration: durationSelect.value };
    let existingIndex = scores.findIndex(s => s.name === userName);
    if (existingIndex >= 0) {
      if (newScore.wpm > scores[existingIndex].wpm) scores[existingIndex] = newScore;
    } else scores.push(newScore);
    scores.sort((a,b) => b.wpm - a.wpm); scores = scores.slice(0, 15);
    localStorage.setItem("leaderboard", JSON.stringify(scores));
    loadLeaderboard();
    resultModal.classList.add("show");
  }

  function updateStats() {
    const typedText = typingInput.value;
    const totalCharacters = typedText.length;
    let currentErrors = 0, currentCorrectCharacters = 0;
    const sampleSpans = sampleTextEl.querySelectorAll('span');
    sampleSpans.forEach((span, index) => {
      const charInSample = testText[index];
      const charInTyped = typedText[index];
      span.classList.remove('correct', 'incorrect', 'current');
      if (index < totalCharacters) {
        if (charInTyped === charInSample) { span.classList.add('correct'); currentCorrectCharacters++; }
        else { span.classList.add('incorrect'); currentErrors++; }
      }
    });
    if (totalCharacters < testText.length) sampleSpans[totalCharacters].classList.add('current');
    errors = currentErrors; typedCharacters = totalCharacters; correctCharacters = currentCorrectCharacters;
    errorsEl.textContent = errors;
    const elapsedSeconds = parseInt(durationSelect.value) - Math.max(0, timeLeft);
    const netWPM = (elapsedSeconds > 0) ? Math.round(((correctCharacters / 5) / (elapsedSeconds / 60))) : 0;
    wpmEl.textContent = isFinite(netWPM) && netWPM > 0 ? netWPM : 0;
    const accuracy = typedCharacters > 0 ? (correctCharacters / typedCharacters) * 100 : 0;
    accuracyEl.textContent = `${accuracy.toFixed(2)}%`;
    if (isTestRunning && typedText.length >= testText.length) endTest();
  }

  function loadLeaderboard() {
    let scores = JSON.parse(localStorage.getItem("leaderboard") || "[]");
    scores.sort((a,b) => b.wpm - a.wpm);
    const filterVal = filterCombo.value;
    let [diff, dur] = filterVal.split("-");
    if (filterVal !== "all") {
      scores = scores.filter(s => s.difficulty === diff && s.duration == dur);
    }
    const tbody = document.querySelector("#leaderboard tbody");
    tbody.innerHTML = "";
    scores.slice(0, 15).forEach((s, i) => {
      let deleteBtn = isAdmin ? `<button onclick="deleteEntry(${i})">‚ùå</button>` : "";
      tbody.innerHTML += `<tr>
        <td>${i+1}</td>
        <td>${s.name}</td>
        <td>${s.wpm}</td>
        <td>${s.accuracy}%</td>
        <td>${s.difficulty}</td>
        <td>${s.duration}s</td>
        <td>${deleteBtn}</td>
      </tr>`;
    });
  }

  window.deleteEntry = function(index) {
    let scores = JSON.parse(localStorage.getItem("leaderboard") || "[]");
    scores.splice(index, 1);
    localStorage.setItem("leaderboard", JSON.stringify(scores));
    loadLeaderboard();
  }

  startBtn.addEventListener('click', startTest);
  resetBtn.addEventListener('click', initializeTest);
  difficultySelect.addEventListener('change', () => {
  updateDurationOptions();   // refresh duration list
  initializeTest();          // reset text + stats
});

durationSelect.addEventListener('change', () => {
  testText = getRandomText(difficultySelect.value);  // only reload text for new duration
  sampleTextEl.innerHTML = "";
  testText.split("").forEach(char => {
    const span = document.createElement("span");
    span.textContent = char;
    sampleTextEl.appendChild(span);
  });
  timeLeft = parseInt(durationSelect.value);   // update timer correctly
  timeLeftEl.textContent = timeLeft;
});

  typingInput.addEventListener('input', updateStats);
  closeModal.addEventListener('click', () => resultModal.classList.remove("show"));
  resetModal.addEventListener('click', () => { resultModal.classList.remove("show"); initializeTest(); });
  filterCombo.addEventListener("change", loadLeaderboard);

  typingInput.addEventListener("paste", e => e.preventDefault());
  typingInput.addEventListener("copy", e => e.preventDefault());
  typingInput.addEventListener("cut", e => e.preventDefault());
  sampleTextEl.addEventListener("copy", e => e.preventDefault());

  // Admin Modal Handling
const adminModal = document.getElementById("adminModal");
const adminPassword = document.getElementById("adminPassword");
const adminSubmit = document.getElementById("adminSubmit");
const adminCancel = document.getElementById("adminCancel");

document.getElementById("adminLogin").addEventListener("click", () => {
  adminPassword.value = "";
  adminModal.classList.add("show");   // show modal
  adminPassword.focus();
});

adminSubmit.addEventListener("click", () => {
  if (adminPassword.value === "1411Nazii") {
    isAdmin = true;
    document.getElementById("adminControls").style.display = "block";
    loadLeaderboard();
    alert("‚úÖ Admin mode activated!");
    adminModal.classList.remove("show");
  } else {
    alert("‚ùå Wrong password!");
  }
});

document.getElementById("adminLogout").addEventListener("click", () => {
  isAdmin = false;
  document.getElementById("adminControls").style.display = "none";
  loadLeaderboard();  // refresh leaderboard to hide delete buttons
  alert("‚úÖ Admin mode deactivated!");
});


adminCancel.addEventListener("click", () => {
  adminModal.classList.remove("show");
});


  document.getElementById("clearLeaderboard").addEventListener("click", () => {
    if (confirm("Clear the entire leaderboard?")) {
      localStorage.removeItem("leaderboard");
      loadLeaderboard();
    }
  });

  initializeTest();
  loadLeaderboard();
})();
</script>
</body>
</html>

